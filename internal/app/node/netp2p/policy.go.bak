package netp2p

import (
	"strings"

	"github.com/spf13/viper"
	"mmesh.dev/m-lib/pkg/ipnet"
)

func getDefaultPolicy() string {
	var defaultPolicy string

	p := viper.GetString("endpoint.traffic.policy.default")
	if len(p) == 0 {
		return ipnet.Policy_ACCEPT
	}

	switch strings.ToUpper(p) {
	case ipnet.Policy_ACCEPT:
		defaultPolicy = ipnet.Policy_ACCEPT
	case ipnet.Policy_DROP:
		defaultPolicy = ipnet.Policy_DROP
	default:
		defaultPolicy = ipnet.Policy_ACCEPT
	}

	return defaultPolicy
}
